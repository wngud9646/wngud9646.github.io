---
title:  "데이터 파이프라인"
excerpt: "DevOps 부트캠프 Section 1 "

categories:
  - Blog
tags:
  - [Blog, DevOps]

toc: true
toc_sticky: true
 
date: 2023-03-30
last_modified_at: 2023-03-30
---
# 데이터 파이프라인
데이터 파이프라인은 데이터를 소스에서 데이터 레이크 또는 데이터 웨어하우스와 같은 종착지로 이동하는 데 사용한다. 


### 파이프라인의 구성 요소
- Data extracting: 데이터 추출
- Data transforming: 데이터 변경
- Data combining: 데이터 결합
- Data validating: 데이터 검증
- Data loading: 데이터 적재

> 이 중 데이터 추출, 변환, 적재를 묶어 ETL이라고 한다. <br>
ETL은 데이터 파이프라인 하위 개념으로, 하나의 시스템에서 데이터를 추출해 변환하여 데이터 베이스 or 데이터 웨어하우스에 차곡차곡 쌓아둔다.


### 데이터 파이프라인 유형
- 실시간 파이프라인<br>
실시간 파이프라인은 분석 및 날씨 예보와 같이 스트리밍 서비스를 통해 데이터를 직접 처리하는 기업 또는 금융 인사이트 산업에서 주로 사용된다.<br>
이러한 시스템은 아키텍처를 통해 즉시 데이터를 처리하고 수백만 개의 이벤트를 적절한 규모로 처리할 수 있으며 매우 안정적인 인사이트를 제공한다.

- 오픈 소스 파이프라인<br>
오픈 소스 파이프라인은 소기업과 일반 대중이 데이터를 이동, 처리, 저장하는 데 사용하는 예산 친화적 시스템이다. <br>
이러한 유형의 파이프라인 지원에 사용하는 툴은 실시간 또는 클라우드 기반 데이터 파이프라인 시스템을 지원하는 툴보다 저렴하다. <br>
이러한 시스템은 대중에게 공개되어 모든 사용 사례에서 목적에 따른 사용자 정의가 필요합니다.

- 클라우드 파이프라인<br>
클라우드 파이프라인은 클라우드 기반 데이터의 활용, 전환, 분석에 사용된다. <br>
현장의 스토리지 인프라가 필요하지 않아 조직이 클라우드 기반 구조에서 데이터를 수집 및 분석할 수 있다. <br>
클라우드 네이티브 파이프라인은 서비스의 특성으로 인해 광범위한 보안 서비스가 포함되는 경우가 많습니다.

일괄 처리 파이프라인<br>
일괄 처리 파이프라인은 데이터 파이프라인 스토리지 시스템 중에서 인기가 많다. <br>
주로 많은 양의 데이터를 일관되게 이동 및 저장하는 데 사용하며, 조직은 일괄 처리 파이프라인 시스템을 통해 이동하는 데이터의 양으로 인해 실시간 시스템보다 느린 속도로 저장 및 분석할 데이터를 해석 및 이동한다.

스트리밍 파이프라인<br>
스트리밍 파이프라인은 일괄 처리 파이프라인과 함께 가장 일반적인 데이터 파이프라인 형태이다.<br> 
사용자는 스트리밍 파이프라인을 통해 다양한 데이터 소스의 구조화된 데이터와 구조화되지 않은 데이터를 처리할 수 있다.


### 데이터 파이프라인 아키텍처
데이터 파이프라인 아키텍처는 데이터 소스, 데이터 처리 시스템, 분석 툴 및 애플리케이션을 연결하는 시스템을 지칭한다.

데이터 파이프라인 아키텍처는 데이터 과학자들이 데이터와 표적 행동에서 인사이트를 확보하고, 고객 여정의 효율성을 향상하며, 사용자 경험을 개선할 수 있도록 관련된 모든 데이터의 수집을 보장한다. <br>
데이터 파이프라인은 원시 데이터를 적절한 스토리지 사이트로 라우팅하고 실행 가능한 인사이트로 전환한다. <br>
데이터 아키텍처는 동적으로 계층화되며, 수집에서부터 지속적인 감시까지 이어진다.

기본적으로 원시 데이터에는 인사이트를 확보하기에 너무 많은 데이터 포인트가 포합된다.<br> 
데이터 파이프라인 아키텍처는 인사이트 확보를 위해 데이터를 캡처, 구조화, 이동하고, 깊이 있게 이해하고 활용하기 위한 분석을 목적으로 구축된 시스템을 사용한다. <br>
주로 자동화, 소프트웨어, 데이터 스토리지 솔루션으로 활용된다.

스토리지 위치는 수집한 데이터의 형식에 따라 결정된다. <br>
데이터를 정확한 스토리지 위치로 보내는 것은 데이터 파이프라인 아키텍처에서 중요한 단계이며, 옵션으로 데이터 웨어하우스와 같은 구조화된 스토리지 시스템에서 마스터링된 데이터를 저장하거나 데이터 레이크에서 느슨하게 구조화된 데이터를 저장할 수 있다. <br>
데이터 애널리스트는 데이터 레이크의 느슨하게 구조화된 데이터에서 데이터 인사이트를 수집하거나 중앙의 스토리지 위치에서 마스터링된 데이터를 분석할 수 있다. <br>
스토리지 환경에 적절하게 배치되지 않은 경우 아키텍처에서 실질적인 감독이 불가능하여 향후 애플리케이션이 더욱 제한된다.

[출처](https://www.hpe.com/kr/ko/what-is/data-pipelines.html) : https://www.hpe.com/kr/ko/what-is/data-pipelines.html

### OTLP
OLTP : 온라인 트랜잭션 처리(Online transaction processing) <br>
트랜잭션 지향 애플리케이션을 손쉽게 관리할 수 있도록 도와주는 정보 시스템의 한 계열이다.<br> OLTP는 시스템이 사용자의 요청에 즉각 반응하는 처리를 가리키는 용어이며 은행 ATM기기의 트랜잭션 처리를 예로 들 수 있다. 보통 이 방법을 금융권, 전산상에서 많이 사용한다. <br>
은행이나 증권거래같은 경우 즉각적인 반응이 매우 중요하기 때문이다.

이 시스템은 AWS의 RDS에 저장된다. 그러면 아마존의 RDW 어디쪽에 저장이 될까? RDS는 MySQL, postgreSQL, MariaDB에 저장된다. 참고로 RDS는 Amazon Relational Database Service를 말한다.


### OLAP
OLAP : 온라인 분석 처리(Online Analytical Processing) <br>
사용자가 동일한 데이터를 가지고 여러 기준으로, 다차원 데이터 분석을 할 수 있도록 도와준다. <br>
의사결정 지원 시스템 중 대표적인 예라 할 수 있다. <br>
DW(Data Warehouse)같은 시스템과 연관되어서 데이터를 분석하며 적극적인 데이터의 활용을 통한 의사결정을 할 수 있게 한다. OLAP의 특성은 다음과 같다.

- 다차원 정보 제공<br>
다차원정보에 직접적으로 대화 형태로 분석하는 것이 OLAP의 특징이다.<br> 
보통 데이터베이스는 2차원인데, 현업에서 요구하는 것은 다차원이다. <br>
그래서 다차원 데이터베이스를 만들고 전문화된 데이터베이스 엔진으로 정보를 추출하는 것이 OLAP이다.

- 중간 매개자 없이 사용자가 직접 데이터 접근<br>
OLAP는 중간 매개자가 없이 사용자가 온라인으로 접근한다. <br>
홈뱅킹, VOD,또는 TV쇼핑 등에 사용할 수 있다.

- 대화형태 정보분석<br>
OLAP는 대화 형태로 정보가 분석된다. <br>
대화로 진행되기 때문에 사용자는 명령을 하고 오래 기다리지 않는다. 따라서 신속성이 중요하다.<br> 
사용자가 질의했을 때 신속하게 처리해야 한다.


### OLTP VS OLAP
OLTP는 현재의 데이터 처리가 얼마나 정확하고, 무결한지가 중요하다. 그렇기 때문에 주로 데이터의 저장, 삭제, 수정 등의 실질적인 데이터를 수정하는 작업을 의미하는 용어이다.

OLAP는 이미 저장된 데이터를 바탕으로 어떤 정보를 제공하는지가 중요하다. 따라서 OLAP는 데이터가 무결하고, 정확하다는 전재를 바탕으로 고객 또는 사용자가 원하는 정보를 어떤식으로 표현하고 제공하는지를 의미하는 용어이다. 

![alt text](/images/otlp.png)
[표 출처](https://too612.tistory.com/511) : 
https://too612.tistory.com/511

[출처](https://simroot.tistory.com/24): https://simroot.tistory.com/24 <br><br>

## 데이터베이스 정규화
정규화(Normalization)의 기본 목표는 테이블 간에 중복된 데이타를 허용하지 않는다는 것이다.<br> 
중복된 데이터를 허용하지 않음으로써 무결성(Integrity)를 유지할 수 있으며, DB의 저장 용량 역시 줄일 수 있다.

이러한 테이블을 분해하는 정규화 단계가 정의되어 있는데, 여기서 테이블을 어떻게 분해되는지에 따라 정규화 단계가 달라지는데, 각각의 정규화 단계에 대해 자세히 알아보도록 하자. 

- 제1 정규화 <br>
제1 정규화란 테이블의 컬럼이 원자값(Atomic Value, 하나의 값)을 갖도록 테이블을 분해하는 것이다. 

- 제 2 정규화 <br>
제2 정규화란 제1 정규화를 진행한 테이블에 대해 완전 함수 종속을 만족하도록 테이블을 분해하는 것이다. 여기서 완전 함수 종속이라는 것은 기본키의 부분집합이 결정자가 되어선 안된다는 것을 의미한다.

- 제 3 정규화 <br>
제3 정규화란 제2 정규화를 진행한 테이블에 대해 이행적 종속을 없애도록 테이블을 분해하는 것이다. 여기서 이행적 종속이라는 것은 A -> B, B -> C가 성립할 때 A -> C가 성립되는 것을 의미한다.

- BCNF 정규화 <br>
BCNF 정규화란 제3 정규화를 진행한 테이블에 대해 모든 결정자가 후보키가 되도록 테이블을 분해하는 것이다.<br><br><br>


## 데이터의 형태
- 정형 데이터(Structured Data)<br>
정형 데이터는 구조화된 데이터, 즉 미리 정해진 구조에 따라 저장된 데이터다. 표 안에서 행과 열에 의해 지정된 각 칸에 데이터를 저장하는 엑셀의 스프레드 시트, 관계 데이터베이스의 테이블이 대표적인 예시이다.

- 반정형 데이터(Semi-Structured Data)<br>
반정형 데이터는 구조에 따라 저장된 데이터지만 정형 데이터와 달리 데이터 내용 안에 구조에 대한 설명이 함께 존재한다. <br>
그렇기 때문에 데이터 내용에 대한 설명인 구조를 파악하는 파싱 과정이 필요하고, 보통 파일 형태로 저장된다. <br>
반정형 데이터의 예시로 웹에서 데이터를 교환하기 위해 작성하는 HTML, XML, JSON 문서나 웹 로그, 센서 데이터 등이 있다.

- 비정형 데이터(Unstructured Data)<br>
비정형 데이터는 정해진 구조가 없이 저장된 데이터다. 소셜 데이터의 텍스트, 이미지, 영상, 워드나 PDF 문서와 같은 멀티미디어 데이터가 대표적인 예다.<br> 
SNS 이용률이 크게 높아지면서 실시간으로 많은 양의 비정형 데이터가 생산되고 있다.<br><br><br>



## ETL과 ELT
ETL / ELT은 모두 다음 세 가지 단계를 포함한다.

- E/Extract(추출) : 원본 데이터베이스 또는 데이터 소스에서 데이터를 가져오는 것을 말한다. 
<br>
ETL을 사용하면 데이터가 임시 스테이징 영역으로 들어가고, ELT를 사용하면 즉시 데이터가 Lake 스토리지 시스템으로 이동한다.
- T/Transform(변환) : 데이터의 구조를 변경하는 프로세스를 의미한다. <br>
용도에 맞는 필터링, Resahping, 정재 등의 단계를 통해 필요한 형태로 변환한다.
- L/Load(적재) : 데이터를 스토리지에 저장하는 프로세스를 의미한다.

### ELT / ETL을 진행하는 이유
ETL과 ELT는 데이터 사이언스 영역에서 필요하다.<br> 
왜냐하면 데이터를 담고 있는 소스는 호환되는 형식으로 저장되어있지 않기 때문이다. <br>
따라서 데이터를 분석 가능한 데이터로 통합하기 전에 Raw 데이터를 정리하고, 많은 정보를 담을 수 있도록 변환해야 한다. <br>
변환한 후에 비로소 분석 도구나 플랫폼을 이용해 데이터가 담는 의미를 파악하고 통찰력을 얻을 수 있다.


### ETL과 ELT의 차이점
1. ETL은 데이터를 추출(E) -> 변환(T) -> 적재(L) 순으로 데이터를 처리하는 프로세스이고, ELT는 추출(E) -> 적재(L) -> 변환(T) 순으로 데이터를 처리하는 프로세스이다.
2. ETL은 데이터 스테이징 단계가 소스와 데이터 웨어 하우스 사이에 있다. ELT는 데이터 웨어하우스를 활용하여 기본 변환을 수행하며, 데이터 스테이징이 필요하지 않다.
3. ETL은 데이터 웨어 하우스에 로드하기 전, 중요 보안 데이터를 처리하여 개인정보 보호 규정을 준수 지원할 수 있다.(실제로 큰 이슈이다. 해싱된 데이터 또한 개인정보 활용 동의 파기 시 활용할 수 없는데 ELT에서는 처리가 곤란하다.)
4. ETL은 정교한 데이터 변환을 수행할 수 있고, ELT보다 비용 효율적이다.



### ETL
![alt text](/images/etl.webp)
OLAP 데이터 웨어하우스는 관계형 SQL 기반 데이터 구조를 지원한다. <br>
그러므로 NoSQL 기반(혹은 관계형 SQL 기반 데이터가 아닌)의 데이터는 OLAP 데이터 웨어하우스에 삽입되기 전 무조건 변환되어야만 한다. <br>
이러한 데이터 변환 프로세스의 일부로, 상관관계에 있는 정보를 기반으로 여러 데이터 소스를 결합하는 데이터 매핑이 필요할 수도 있다.<br> 
따라서 데이터 웨어하우스는 ETL이 필요하다. Load 단계 이전에 무조건 변환이 완료되어야 하기 때문이다.  


#### ETL의 특징
- 워크플로우가 잘 정의되어 있어야 하며 연속적이고 지속적인 프로세스를 가진다 : <br>
ETL은 동종 또는 이종의 데이터 소스에서 데이터를 추출하여, 스테이징 영역에 임시 보관한다.<br> 
그 영역에서 데이터는 필터링, Reshaping 등의 프로세스를 거치고 마지막으로 데이터 웨어 하우스에 저장된다.
- 데이터 엔지니어 및 개발자의 상세 계획, 감독 및 코딩이 필요하다 : <br>
데이터 웨어하우스에서 ETL을 손으로 코딩하는 구식 방법은 엄청난 시간이 소요된다. <br>
프로세스를 설계한 후에도 새로운 정보로 데이터 웨어하우스를 업데이트할 때 각 단계를 거치는데 시간이 걸린다.
- 최신 ETL 솔루션은 쉽고 빠르다 : <br>
특히 클라우드 기반 데이터 웨어하우스 및 클라우드 기반 SaaS 플랫폼의 경우 ETL이 훨씬 더 빠르게 실행된다. <br>
Xplentity와 같은 클라우드 기반 ETL 솔루션을 사용하면 프로그래밍 전문 지식이 없어도 다양한 소스에서 데이터를 즉시 추출, 변환, 적재할 수 있다.<br><br>

#### ETL의 장점
- ELT에 비해 ETL의 가장 큰 장점 중 하나는 OLAP 데이터 웨어하우스의 특성과 관련이 있다. <br>
데이터를 구조화/변환한 후 ETL을 통해 보다 효율적이며 안정적인 데이터 분석이 가능하다.<br> 이와는 대조적으로, ELT는 빠른 분석이 필요할 때는 이상적인 방법이 아니다.

- 또 다른 ETL의 장점은 보안 규정 준수와 관련이 있다. <br>
로그 데이터에서 발생한 고객의 프라이버시 데이터는 특정 필드를 제거하거나 암호화해야 한다. <br>
ETL은 데이터를 데이터 웨어하우스에 넣기 전에 변환하기 때문에, 보안 규정 위반 위험성을 줄여준다. <br>
이와는 반대로 ELT는 개인정보와 관련된 중요한 데이터를 먼저 적재해야 한다. <br>
이로 인해 보안 규정을 위반할 수 있다. 

- 마지막으로, 데이터 integration/transfroamtion 프로세스로서 ETL은 20년 넘는 기술 스택을 쌓아왔고, 이는 ETL을 진행하기 위해서 잘 개발된 도구와 플랫폼이 많이 있다는 것을 의미한다. <br>
또한, ETL 파이프라인 구축에 숙련되고 경험이 풍부한 데이터 엔지니어가 많다는 뜻이기도 하다.<br><br>


### ELT
ELT란 데이터를 먼저 추출 적재한 이후 변환을 하는 프로세스를 의미한다. <br>
ELT에서는 데이터 웨어하우스에서 데이터 변환이 일어난다. <br>
즉, 데이터 스테이징이 필요하지 않다. <br>
ELT는 클라우드 기반 데이터 웨어 하우스 솔루션을 사용하여 정형, 비정형, 반정형(semi-structured) 데이터 유형의 모든 데이터 타입을 활용할 수 있다.

ELT는 데이터 레이크(Data Lakes)에서 동작한다. Data Lakes란 OLAP 데이터 웨어하우스와 달리 정형, 비정형 데이터 모두를 수용하는 특별한 종류의 데이터 저장소이다. <br>
데이터를 로드하기 전에 데이터를 변환할 필요가 없다. 형식이나 데이터 종류에 관계없이 모든 유형을 Raw 데이터 형태로 적재할 수 있다.<br>
하지만 여전히 BI(Business intellgence) 플랫폼을 이용해 분석하기 위해서는 데이터 변환이 필요하다. <br>
그래서 데이터 변환 과정은 데이터 레이크에 적재된 후에 수행된다. 


#### ELT의 특징
- 기술의 발전 덕분에 가능해진 고속 클라우드 서버 기반 프로세스이다 : <br>
ELT는 최신 클라우드 기반 기술 덕분에 가능해진 비교적 새로운 기술이다. <br>
클라우드 기반 데이터 웨어하우스는 거의 무제한에 가까운 스토리지 기능과 확장 가능한 처리 능력을 제공한다. <br>
Amazon Redshift와 Google BigQuery와 같은 플랫폼은 엄청난 처리 능력 덕분에 ELT 파이프라인을 가능하게 한다.

- 모든 데이터를 수집 가능하다 : <br>
ELT를 사용하면 지속적으로 확장되는 Raw 데이터를 즉시 수집 가능하다. <br>
데이터를 데이터 레이크에 저장하기 전에 데이터를 특수한 형태로 변환할 필요가 없다.

- 필요한 데이터만 변환한다 : <br>
ELT는 특정 분석에 필요한 데이터만 변환한다. 데이터 분석 프로세스가 느려질 수 있지만, 다양한 방식으로 즉시 변환하여 다양한 유형의 메트릭, 예측 및 보고서를 생성할 수 있기 때문에 유연성이 향상된다. <br>
반대로 ETL의 경우 OLAP 웨어하우스 전체 ETL 파이프 라인 및 데이터 구조에서 새로운 유형의 분석이 허용되지 않는 경우 전체 프로세스를 수정해야 할 필요할 수 있다.

- ELT는 ETL보다 신뢰성이 낮다 : <br>
ELT의 툴과 시스템은 여전히 발전하고 있고, OLAP 데이터베이스와 결합된 ETL만큼 안정적이지는 않다. <br>
또한 ELT 기술을 사용할 줄 아는 개발자는 ETL 개발자보다 찾기가 더 어렵다.


### ELT의 장점
ETL에 비해 ELT의 주요 이점은 새로운 비정형 데이터에 대한 유연성 및 저장 용이성과 관련이 있다. <br>
ELT를 사용하면 먼저 정보를 변환하고 구성할 시간이나 기능이 없어도 모든 유형의 정보를 저장할 수 있으므로 원하는 경우 언제든지 모든 정보에 즉시 액세스 할 수 있다. <br>
또한 데이터를 수집하기 전에 복잡한 ETL 프로세스를 개발할 필요가 없으며, 개발자와 BI 분석가가 새로운 정보를 처리하는데 소요되는 시간을 절약할 수 있다.

1. 빠르다 - 데이터 가용성에 있어서는 ELT가 더 빠른 옵션이다. <br>
ELT는 모든 데이터를 즉시 시스템으로 전송할 수 있도록 하며, 거기서 사용자는 변환과 분석에 필요한 데이터를 스스로 결정할 수 있다.
2. 유지 보수 비용이 낮다 - ELT를 사용하면 일반적으로 손이 많이 가는 유지 관리 계획을 수립할 필요가 없다. <br>
ELT는 클라우드 기반이므로 사용자가 수동 업데이트를 시작하지 않고 자동화된 솔루션을 활용한다.
3. 짧은 적재(Load) 시간 - 변환 단계는 데이터 웨어하우스에 진입한 후에 발생하기 때문에, 데이터를 최종 위치에 로드하는데 걸리는 시간을 줄인다. <br>
데이터가 정리되거나 수정될 때까지 기다릴 필요가 없으며, 한 번만 이동하면 된다.


#### 어느 경우에 사용할까?
ETL과 ELT는 각각의 장단이 있다. ETL 대신 언제 ELT를 사용하는 게 좋을까?

1. 방대한 양의 데이터를 보유했을 경우 - ELT는 정형 데이터와 비정형 데이터 모두에서 잘 작동한다. 시스템이 클라우드 기반인 한 ELT 프로세스를 통해 방대한 양의 데이터를 보다 신속하게 처리할 수 있다.
2. 가능한 한 빨리 모든 데이터를 한 곳에 보관해야 할 경우 - 프로세스가 종료될 때 ELT는 전송 속도를 다른 모든 데이터보다 우선시한다.
3. 데이터를 처리할 수 있는 리소스를 가지지 못했을 경우 - ETL를 사용하면 데이터 웨어하우스에 도착하기 전 파이프라인에서 데이터 변환이 일어나야 한다. 이때 요구되는 리소스는 상황에 따라 매우 클 수가 있는데, ELT 방식을 이용하면 추후 필요 데이터만 변환함으로써 경제적 유연성을 갖출 수 있다.


[출처](https://dining-developer.tistory.com/50) : https://dining-developer.tistory.com/50



## MLOps
개발과 운영을 따로 나누지 않고 개발의 생산성과 운영의 안정성을 최적화하기 위한 문화이자 방법론이 DevOps이며, 이를 ML 시스템에 적용한 것이 MLOps이다. <br>
MLOps는 ML의 전체 Lifecycle를 관리해야 한다.

MLOps란 단순히 ML 모델뿐만 아니라, 데이터를 수집하고 분석하는 단계(Data Collection, Ingestion, Analysis, Labeling, Validation, Preparation), 그리고 ML 모델을 학습하고 배포하는 단계(Model Training, Validation, Deployment)까지 전 과정을 AI Lifecycle로 보고, MLOps의 대상으로 보고 있다.<br>
ML에 기여하는 Engineer들(Data Scientist, Data Engineer, SW Engineer)이 이 Lifecycle을 관리하고 모니터링해야 한다.

머신러닝을 엔터프라이즈 레벨에서 서비스에 구현하고자 한다면, MLOps는 선택이 아니라 반드시 구현해야하는 방향이다. <br>
최고수준 모범사례까지는 못하더라도 최소한 어느 정도 수준까지는
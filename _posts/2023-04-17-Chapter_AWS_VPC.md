---
title:  "VPC"
excerpt: "DevOps 부트캠프 Section 2 "

categories:
  - Blog
tags:
  - [Blog, DevOps]

toc: true
toc_sticky: true
 
date: 2023-04-17
last_modified_at: 2023-04-17
---
# Virtual Private Cloud (VPC)
AWS에서 제공하는 가상 사설 네트워크 서비스입니다. <br>
VPC를 사용하면 사용자는 자신만의 가상 네트워크를 구축하여 AWS 리소스를 안전하게 연결할 수 있습니다.

VPC는 사용자가 정의한 IP 주소 범위와 서브넷을 가지고 있습니다.  <br>
사용자는 VPC 내에서 자신만의 서브넷을 구성할 수 있으며, 이를 통해 EC2 인스턴스, RDS 데이터베이스 인스턴스, ElastiCache 클러스터 등을 배치할 수 있습니다.  <br>
VPC 내의 서브넷은 가용 영역과 연결됩니다.

VPC는 다양한 보안 기능을 제공합니다. <br>
예를 들어, VPC 내에서는 보안 그룹을 사용하여 인스턴스에 대한 인바운드 및 아웃바운드 트래픽을 제어할 수 있습니다. <br>
또한, Network ACLs를 사용하여 서브넷에 대한 트래픽을 제어하고, VPN 연결을 사용하여 사용자가 자신의 데이터 센터 또는 다른 클라우드 서비스와 VPC 간의 안전한 연결을 설정할 수 있습니다.

<br><br>

## IP Address
IP Address (Internet Protocol Address)는 컴퓨터 네트워크에서 사용하는 고유한 식별자입니다. <br>
모든 네트워크 기기는 IP 주소를 갖고 있으며, 이 주소를 통해 인터넷이나 내부 네트워크에서 다른 기기와 통신합니다.

IP 주소는 네트워크 레이어에서 사용되며, IPv4와 IPv6 두 가지 버전이 있습니다. <br>
IPv4는 32비트의 숫자로 구성된 주소 체계이며, 4개의 숫자로 구분되어 각 숫자는 0부터 255까지의 값을 가집니다. <br>
예를 들어, "192.168.0.1"과 같은 형태입니다. 그리고 IPv6는 128비트의 주소 체계이며, 16진수로 구성되어 있습니다. <br>
예를 들어,"2001:0db8:85a3:0000:0000:8a2e:0370:7334"와 같은 형태입니다.

IP 주소는 인터넷 상에서 서로 다른 기기들이 통신하기 위해 필요한 기본적인 정보입니다.<br>
기기가 네트워크에 접속하면, 해당 기기는 IP 주소를 할당받게 되며, 이를 통해 다른 기기들과 통신합니다. IP 주소를 통해, 데이터를 보낼 대상의 위치를 찾아가는데, 이를 라우팅이라고 합니다.

IP 주소는 인터넷 접속 시 공인 IP 주소와 사설 IP 주소로 나눌 수 있습니다. <br>
공인 IP 주소는 인터넷 서비스 제공자(ISP)에 의해 할당되며, 인터넷을 통해 직접 접근 가능한 주소입니다. <br>
반면, 사설 IP 주소는 공인 IP 주소와 다르게 내부 네트워크에서 사용되며, 인터넷을 통해 접근할 수 없는 주소입니다. 사설 IP 주소는 라우터나 게이트웨이를 통해 공인 IP 주소로 변환되어 인터넷으로 접근할 수 있게 됩니다.

<br><br>

## CIDR
CIDR(Classless Inter-Domain Routing)는 IP 주소를 보다 유연하게 할당하기 위해 개발된 주소 체계입니다. <br>
이전에는 IP 주소를 클래스 A, B, C 등으로 나누어 할당하였지만, 이 방식은 낭비되는 IP 주소가 많아졌습니다.

CIDR은 IP 주소의 네트워크 부분과 호스트 부분을 구분하는 기술입니다. <br>
예를 들어, "192.168.0.0/24"라는 주소를 살펴봅시다. 이 주소는 "192.168.0"이라는 네트워크 부분과 "0"이라는 호스트 부분으로 구분됩니다. <br>
"/24"는 이 주소가 네트워크 부분의 길이가 24비트라는 것을 의미합니다. 이를 통해 호스트 부분의 길이를 유동적으로 할당할 수 있으며, IP 주소 할당의 효율성을 높일 수 있습니다.

CIDR을 사용하면 IP 주소 할당이 보다 유연해지며, IPv4의 주소 부족 문제를 해결할 수 있습니다. <br>
또한, CIDR은 라우팅 테이블의 크기를 줄이고 라우터의 처리 성능을 향상시키는 효과도 있습니다.


## 서브넷
서브넷(Subnet)은 하나의 대규모 네트워크를 작은 네트워크로 분할하는 기술입니다. <br>
대규모 네트워크를 서브넷으로 나누면, 보안성을 높일 수 있고, 네트워크 전송의 효율성을 높일 수 있습니다.

Amazon VPC(Virtual Private Cloud)에서의 서브넷은 VPC 내에서 논리적으로 분리된 네트워크입니다. <br>
서브넷은 VPC의 IP 주소 범위를 기반으로 생성됩니다.

서브넷은 CIDR 블록을 할당받아 구성됩니다.<br>
이 CIDR 블록은 VPC의 IP 주소 범위 내에서 새로운 IP 주소 범위를 정의합니다. <br>
즉, 서브넷은 VPC 내에서 IP 주소를 부여받은 논리적인 서브 영역이며, 이 서브넷은 VPC의 다른 서브넷과 격리되어 있습니다.

서브넷은 VPC 내에서 리소스를 배치하는 데 사용됩니다. <br>
예를 들어, 서브넷은 EC2 인스턴스, RDS 데이터베이스 등의 리소스를 배치하는 데 사용됩니다. <br>
VPC 내에서 서브넷을 사용하면, 서브넷마다 보안 그룹 및 네트워크 ACL 등의 보안 그룹 규칙을 설정할 수 있으므로, 더욱 견고한 보안성을 갖출 수 있습니다.

서브넷은 공용 서브넷과 사설 서브넷으로 구분됩니다. <br>
공용 서브넷은 인터넷 게이트웨이와 연결하여 인터넷에서 액세스할 수 있는 서브넷입니다.<br>
반면에, 사설 서브넷은 인터넷과 연결되어 있지 않으며, VPC 내에서만 액세스 가능한 서브넷입니다. <br>
이를 통해, 공용 서브넷과 사설 서브넷을 분리함으로써, 리소스의 보안을 보다 강화할 수 있습니다.

AWS가 확보한 서브넷 중 처음 네 개의 IP주소와 마지막 IP주소는 인터넷 네트워킹을 위해 예약되어 있다.<br>
AWS가 확보한 서브넷에서 첫 번째 IP 주소와 마지막 IP 주소는 각각 네트워크의 식별자와 브로드캐스트 주소로 사용되기 때문에, 사용이 제한됩니다.<br>
AWS에서는 기본적으로 첫 번째 IP 주소를 VPC의 라우팅 테이블에 연결된 로컬 라우트로 사용하므로, 이 역시 예약됩니다.


## 라우팅 테이블
라우팅 테이블(Route Table)은 네트워크에서 데이터를 전송할 때, 목적지 주소로부터 다음에 어느 경로로 데이터를 전송할지를 결정하는 데 사용되는 테이블입니다. <br>
즉, 목적지 IP 주소에 대한 경로 정보를 담고 있는 데이터베이스이며, 이를 통해 IP 패킷이 전송되는 경로를 결정합니다.

Amazon VPC(Virtual Private Cloud)에서 라우팅 테이블(Route Table)은 VPC 내에서 인바운드와 아웃바운드 트래픽을 전달하는 데 사용됩니다. <br>
VPC 내에 생성된 각 서브넷은 하나의 라우팅 테이블에 연결됩니다.

라우팅 테이블은 목적지 CIDR과 연결된 대상을 지정하는 라우트들로 구성됩니다. <br>
즉, 라우팅 테이블은 네트워크 트래픽을 목적지 CIDR에 대한 대상으로 라우팅하는 역할을 합니다. <br>
VPC 내에서 라우팅 테이블은 다음과 같은 용도로 사용됩니다.

- 인터넷 게이트웨이(IGW) 라우팅: 공용 서브넷에 대한 인터넷 연결을 위한 라우팅 테이블을 구성합니다. <br>
이 라우팅 테이블은 IGW를 대상으로 하는 라우트를 포함해야 하며, 이를 통해 공용 서브넷에서 인터넷으로부터의 인바운드 및 아웃바운드 트래픽을 처리할 수 있습니다.

- NAT 게이트웨이 라우팅: 사설 서브넷에서 인터넷에 대한 연결을 위해 NAT 게이트웨이를 사용하는 경우, 해당 서브넷에 대한 라우팅 테이블을 구성합니다. <br>
이 라우팅 테이블은 NAT 게이트웨이를 대상으로 하는 라우트를 포함해야 하며, 이를 통해 사설 서브넷에서 인터넷으로의 아웃바운드 트래픽을 NAT 게이트웨이를 통해 전송할 수 있습니다.

- VPC 피어링 라우팅: 두 개 이상의 VPC를 피어링할 경우, 각 VPC에 대한 라우팅 테이블을 구성합니다. <br>
이 라우팅 테이블은 피어링 연결을 대상으로 하는 라우트를 포함해야 하며, 이를 통해 서로 다른 VPC 간에 인바운드 및 아웃바운드 트래픽을 처리할 수 있습니다.

라우팅 테이블을 구성함으로써, VPC 내의 각 서브넷이 어떤 대상과 어떤 조건으로 통신할 수 있는지 제어할 수 있습니다.


## NACL
네트워크 액세스 제어 목록(Network Access Control List, NACL)은 AWS VPC(Virtual Private Cloud)에서 서브넷(Subnet) 수준에서 인바운드(Inbound) 및 아웃바운드(Outbound) 트래픽을 제어하는 네트워크 방화벽입니다.

NACL은 서브넷과 연결되어 있으며, 각 서브넷에 대해 별도로 구성될 수 있습니다. <br>
서브넷의 인바운드 및 아웃바운드 트래픽을 제어하여 보안 요구사항을 충족시키고 허용된 트래픽만을 통과시키는 역할을 수행합니다.

NACL은 간단한 규칙 기반의 방화벽이며, 각 규칙은 순서대로 적용됩니다. <br>
이를 통해 특정 IP 주소, 포트 및 프로토콜 등을 사용하여 트래픽을 필터링할 수 있습니다.

NACL은 보안 그룹(Security Group)과 함께 사용되며, 보안 그룹은 인스턴스 수준에서 적용되는 방화벽이고, NACL은 서브넷 수준에서 적용되는 방화벽입니다. <br>
보안 그룹은 상태를 추적하며, NACL은 상태를 추적하지 않습니다.

또한, NACL은 보안 그룹보다 더 세부적인 제어가 가능하지만, 처리 속도가 느리고 복잡성이 높기 때문에 보안 그룹보다 덜 사용됩니다.


reference: Chat GPT



## TIL
Sprint를 진행하면서 AWS의 EC2, S3, RDS를 직접 사용해 보았다.<br>
다른 Sprint에서도 진행한 똑같은 tier 3 아키텍처인데도, AWS를 통해 사용하다보니 색다르고 어렵게 느껴졌다.<br>
이번 Sprint에서 느낀점은 보안 그룹의 중요성이다.<br>
보안 그룹이 제대로 설정되어있지 않는다면 백날해도 안된다.<br>
실제로 처음에 RDS 생성한 후에 RDS에 인바운드 규칙을 추가 안했더니 접속이 계속 안되가지고 어리둥절 했던 상황이 있었다.<br>
다른 느낀 점은 상당히 막막하다는 점이였다.<br>

AWS의 기능들의 다양성과 활용성에 대해서 아는 것이 너무 적고, 활용하기 힘든 경험을 오늘 많이 겪게 되었다.<br>
해당 기능들에 숙달되기 위해서 많은 노력과 공부가 필요하다는 부분은 확실하다.<br>
다음 프로젝트를 위해 좀 더 많은 이해와 노력과 활용법에 대한 고민이 필요하다고 생각된다.<br>